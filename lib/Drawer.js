Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _jsxFileName='src/Drawer.js';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactNative=require('react-native');var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _Ionicons=require('react-native-vector-icons/Ionicons');var _Ionicons2=_interopRequireDefault(_Ionicons);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _Dimensions$get=_reactNative.Dimensions.get('window'),width=_Dimensions$get.width,height=_Dimensions$get.height;var Drawer=function(_Component){_inherits(Drawer,_Component);function Drawer(){var _ref;var _temp,_this,_ret;_classCallCheck(this,Drawer);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=Drawer.__proto__||Object.getPrototypeOf(Drawer)).call.apply(_ref,[this].concat(args))),_this),_this.state={open:false,pulling:false,scrollOffset:0},_this.config={position:{max:height,start:height-_this.props.teaserHeight,end:_this.props.headerHeight,min:_this.props.headerHeight,animates:[function(){return _this._animatedOpacity;},function(){return _this._animatedWidth;}]},width:{end:width,start:width-20},opacity:{start:0,end:1}},_this._panResponder={},_this._animatedOpacity=new _reactNative.Animated.Value(_this.config.opacity.start),_this._animatedWidth=new _reactNative.Animated.Value(_this.config.width.start),_this._animatedPosition=new _reactNative.Animated.Value(_this.props.isOpen?_this.config.position.end:_this.config.position.start),_this._grantPanResponder=function(evt,gestureState){if(!_this.state.open){return true;}else if(_this.pulledDown(gestureState)&&_this.state.scrollOffset<=0){return true;}else if(_this.pulledDown(gestureState)&&_this.pulledFast(gestureState)){return true;}return false;},_this._handlePanResponderGrant=function(evt,gestureState){_this.setState({pulling:true});_this._animatedPosition.setOffset(_this._currentPosition);_this._animatedPosition.setValue(0);},_this._handlePanResponderMove=function(evt,gestureState){if(_this.insideAllowedRange()){_this._animatedPosition.setValue(gestureState.dy);}},_this._handlePanResponderEnd=function(evt,gestureState){_this._animatedPosition.flattenOffset();_this.setState({pulling:false});if(_this.pulledDown(gestureState)&&_this.pulledFar(gestureState)){return _this.close();}else if(_this.pulledUp(gestureState)&&_this.pulledFar(gestureState)){return _this.open();}else if(_this.tapped(gestureState)){return _this.toggle();}else{_this.restore();}},_this._handleScroll=function(event){var y=event.nativeEvent.contentOffset.y;_this.setState({scrollOffset:y});},_this.tapped=function(gestureState){return gestureState.dx===0&&gestureState.dy===0;},_this.pulledUp=function(gestureState){return gestureState.dy<0;},_this.pulledDown=function(gestureState){return gestureState.dy>0;},_this.pulledFast=function(gestureState){return Math.abs(gestureState.vy)>0.75;},_this.pulledFar=function(gestureState){return Math.abs(gestureState.dy)>50;},_this.insideAllowedRange=function(){return _this._currentPosition>=_this.config.position.min&&_this._currentPosition<=_this.config.position.max;},_this.open=function(){_this.setState({open:true},function(){_reactNative.Animated.timing(_this._animatedPosition,{toValue:_this.config.position.end,duration:400}).start(function(){_this.props.onOpened();});});},_this.close=function(){_this._scrollView.scrollTo({y:0});_reactNative.Animated.timing(_this._animatedPosition,{toValue:_this.config.position.start,duration:400}).start(function(){_this.setState({open:false},function(){_this.props.onClosed();});});},_this.toggle=function(){if(!_this.state.open){_this.open();}else{_this.close();}},_this.restore=function(){if(_this.state.open){_this.open();}else{_this.close();}},_this.getHeaderStyle=function(){return{height:_reactNative.Platform.OS==='ios'?_this.props.headerHeight:_this.props.headerHeight-40};},_this.getContainerStyle=function(){return{zIndex:_this.state.pulling||_this.state.open?1:-1};},_temp),_possibleConstructorReturn(_this,_ret);}_createClass(Drawer,[{key:'componentWillMount',value:function componentWillMount(){var _this2=this;this._currentPosition=this._animatedPosition._value;this._animatedPosition.addListener(function(value){_this2._currentPosition=value.value;_this2.config.position.animates.map(function(item){item().setValue(value.value);});});this._animatedPosition.setValue(this._animatedPosition._value);this._panResponder=_reactNative.PanResponder.create({onStartShouldSetPanResponder:this._grantPanResponder,onStartShouldSetPanResponderCapture:this._grantPanResponder,onMoveShouldSetPanResponder:this._grantPanResponder,onMoveShouldSetPanResponderCapture:this._grantPanResponder,onPanResponderGrant:this._handlePanResponderGrant,onPanResponderMove:this._handlePanResponderMove,onPanResponderTerminationRequest:function onPanResponderTerminationRequest(evt,gestureState){return true;},onPanResponderRelease:this._handlePanResponderEnd,onPanResponderTerminate:this._handlePanResponderEnd,onShouldBlockNativeResponder:function onShouldBlockNativeResponder(evt,gestureState){return true;}});}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(nextProps){if(!this.props.isOpen&&nextProps.isOpen){this.open();}else if(this.props.isOpen&&!nextProps.isOpen){this.close();}}},{key:'render',value:function render(){var _this3=this;var _props=this.props,children=_props.children,header=_props.header,animatedOpacity=this._animatedOpacity.interpolate({inputRange:[this.config.position.end,this.config.position.start],outputRange:[this.config.opacity.end,this.config.opacity.start]}),animatedWidth=this._animatedWidth.interpolate({inputRange:[this.config.position.min,this.config.position.start-50,this.config.position.start,this.config.position.max],outputRange:[this.config.width.end,this.config.width.end,this.config.width.start,this.config.width.start]});return _react2.default.createElement(_reactNative.Animated.View,{style:[styles.container,this.getContainerStyle()],__source:{fileName:_jsxFileName,lineNumber:166}},_react2.default.createElement(_reactNative.StatusBar,{barStyle:"light-content",__source:{fileName:_jsxFileName,lineNumber:168}}),_react2.default.createElement(_reactNative.Animated.View,{style:[styles.backdrop,{opacity:animatedOpacity}],__source:{fileName:_jsxFileName,lineNumber:170}},_react2.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:this.close,__source:{fileName:_jsxFileName,lineNumber:172}},_react2.default.createElement(_reactNative.View,{style:[styles.header,this.getHeaderStyle()],__source:{fileName:_jsxFileName,lineNumber:173}},_react2.default.createElement(_reactNative.View,{style:styles.headerIcon,__source:{fileName:_jsxFileName,lineNumber:175}},_react2.default.createElement(_Ionicons2.default,{name:'md-arrow-up',size:24,color:'white',__source:{fileName:_jsxFileName,lineNumber:176}})),_react2.default.createElement(_reactNative.View,{style:styles.headerTitle,__source:{fileName:_jsxFileName,lineNumber:179}},_react2.default.createElement(_reactNative.Text,{style:styles.headerText,__source:{fileName:_jsxFileName,lineNumber:180}},header))))),_react2.default.createElement(_reactNative.Animated.View,_extends({style:[styles.content,{paddingBottom:this.props.headerHeight,width:animatedWidth,transform:[{translateY:this._animatedPosition},{translateX:0}]}]},this._panResponder.panHandlers,{__source:{fileName:_jsxFileName,lineNumber:186}}),_react2.default.createElement(_reactNative.ScrollView,{ref:function ref(scrollView){_this3._scrollView=scrollView;},scrollEnabled:this.state.open,showsHorizontalScrollIndicator:false,showsVerticalScrollIndicator:false,scrollEventThrottle:16,onScroll:this._handleScroll,__source:{fileName:_jsxFileName,lineNumber:199}},children)));}}]);return Drawer;}(_react.Component);Drawer.propTypes={children:_propTypes2.default.any,isOpen:_propTypes2.default.bool,header:_propTypes2.default.string,headerHeight:_propTypes2.default.number,teaserHeight:_propTypes2.default.number,onOpened:_propTypes2.default.func,onClosed:_propTypes2.default.func};Drawer.defaultProps={isOpen:false,header:'Messages',headerHeight:70,teaserHeight:75,onOpened:function onOpened(){},onClosed:function onClosed(){}};exports.default=Drawer;var styles=_reactNative.StyleSheet.create({container:_extends({},_reactNative.StyleSheet.absoluteFillObject,{alignItems:'center',justifyContent:'flex-end',backgroundColor:'transparent'}),backdrop:_extends({},_reactNative.StyleSheet.absoluteFillObject,{alignItems:'center',justifyContent:'flex-start',backgroundColor:'black'}),content:{backgroundColor:'black',height:height},header:{flexDirection:'row',alignItems:'center',paddingTop:20,paddingHorizontal:20},headerIcon:{marginRight:10},headerTitle:{flex:1},headerText:{color:'white',fontFamily:'Avenir',fontWeight:'600',fontSize:16}});